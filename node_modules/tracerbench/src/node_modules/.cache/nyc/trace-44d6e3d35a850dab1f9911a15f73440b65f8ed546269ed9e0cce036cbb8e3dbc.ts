"use strict";function cov_1wmjbuuxyq(){var path="/Users/malynch/D/tracerbench/packages/cli/src/commands/trace.ts";var hash="7cbbfb80f4354f6562c91b3e7024040c87468e49";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/malynch/D/tracerbench/packages/cli/src/commands/trace.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:4,column:15},end:{line:4,column:43}},"2":{start:{line:5,column:19},end:{line:5,column:38}},"3":{start:{line:6,column:15},end:{line:6,column:30}},"4":{start:{line:7,column:25},end:{line:7,column:53}},"5":{start:{line:8,column:16},end:{line:8,column:43}},"6":{start:{line:9,column:16},end:{line:9,column:43}},"7":{start:{line:12,column:26},end:{line:12,column:43}},"8":{start:{line:13,column:85},end:{line:13,column:90}},"9":{start:{line:14,column:22},end:{line:14,column:27}},"10":{start:{line:15,column:22},end:{line:22,column:9}},"11":{start:{line:23,column:24},end:{line:23,column:28}},"12":{start:{line:24,column:27},end:{line:27,column:9}},"13":{start:{line:28,column:8},end:{line:30,column:9}},"14":{start:{line:29,column:12},end:{line:29,column:77}},"15":{start:{line:33,column:8},end:{line:40,column:9}},"16":{start:{line:34,column:12},end:{line:36,column:13}},"17":{start:{line:35,column:16},end:{line:35,column:54}},"18":{start:{line:39,column:12},end:{line:39,column:30}},"19":{start:{line:42,column:24},end:{line:42,column:74}},"20":{start:{line:43,column:8},end:{line:43,column:111}},"21":{start:{line:45,column:8},end:{line:52,column:9}},"22":{start:{line:46,column:12},end:{line:51,column:13}},"23":{start:{line:47,column:16},end:{line:47,column:57}},"24":{start:{line:50,column:16},end:{line:50,column:124}},"25":{start:{line:54,column:32},end:{line:54,column:97}},"26":{start:{line:55,column:31},end:{line:59,column:9}},"27":{start:{line:61,column:8},end:{line:61,column:45}},"28":{start:{line:64,column:30},end:{line:64,column:31}},"29":{start:{line:65,column:31},end:{line:65,column:32}},"30":{start:{line:66,column:27},end:{line:66,column:36}},"31":{start:{line:67,column:8},end:{line:72,column:9}},"32":{start:{line:68,column:12},end:{line:68,column:56}},"33":{start:{line:71,column:12},end:{line:71,column:35}},"34":{start:{line:73,column:8},end:{line:81,column:11}},"35":{start:{line:74,column:31},end:{line:74,column:62}},"36":{start:{line:75,column:31},end:{line:75,column:50}},"37":{start:{line:77,column:24},end:{line:77,column:43}},"38":{start:{line:78,column:33},end:{line:78,column:49}},"39":{start:{line:79,column:12},end:{line:79,column:44}},"40":{start:{line:80,column:12},end:{line:80,column:63}},"41":{start:{line:83,column:8},end:{line:83,column:88}},"42":{start:{line:85,column:8},end:{line:93,column:11}},"43":{start:{line:86,column:31},end:{line:86,column:69}},"44":{start:{line:87,column:31},end:{line:87,column:60}},"45":{start:{line:89,column:24},end:{line:89,column:53}},"46":{start:{line:90,column:33},end:{line:90,column:49}},"47":{start:{line:91,column:12},end:{line:91,column:45}},"48":{start:{line:92,column:12},end:{line:92,column:64}},"49":{start:{line:95,column:8},end:{line:95,column:90}},"50":{start:{line:97,column:8},end:{line:106,column:9}},"51":{start:{line:98,column:28},end:{line:98,column:70}},"52":{start:{line:99,column:12},end:{line:102,column:15}},"53":{start:{line:100,column:72},end:{line:100,column:86}},"54":{start:{line:101,column:16},end:{line:101,column:112}},"55":{start:{line:105,column:12},end:{line:105,column:30}},"56":{start:{line:107,column:8},end:{line:116,column:9}},"57":{start:{line:108,column:12},end:{line:108,column:56}},"58":{start:{line:109,column:30},end:{line:109,column:64}},"59":{start:{line:110,column:12},end:{line:112,column:15}},"60":{start:{line:111,column:16},end:{line:111,column:67}},"61":{start:{line:115,column:12},end:{line:115,column:35}},"62":{start:{line:119,column:0},end:{line:119,column:24}},"63":{start:{line:120,column:0},end:{line:120,column:125}},"64":{start:{line:121,column:0},end:{line:128,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:4},end:{line:11,column:5}},loc:{start:{line:11,column:16},end:{line:117,column:5}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:74,column:20},end:{line:74,column:21}},loc:{start:{line:74,column:31},end:{line:74,column:62}},line:74},"2":{name:"(anonymous_2)",decl:{start:{line:75,column:20},end:{line:75,column:21}},loc:{start:{line:75,column:31},end:{line:75,column:50}},line:75},"3":{name:"(anonymous_3)",decl:{start:{line:76,column:21},end:{line:76,column:22}},loc:{start:{line:76,column:32},end:{line:81,column:9}},line:76},"4":{name:"(anonymous_4)",decl:{start:{line:86,column:20},end:{line:86,column:21}},loc:{start:{line:86,column:31},end:{line:86,column:69}},line:86},"5":{name:"(anonymous_5)",decl:{start:{line:87,column:20},end:{line:87,column:21}},loc:{start:{line:87,column:31},end:{line:87,column:60}},line:87},"6":{name:"(anonymous_6)",decl:{start:{line:88,column:21},end:{line:88,column:22}},loc:{start:{line:88,column:32},end:{line:93,column:9}},line:88},"7":{name:"(anonymous_7)",decl:{start:{line:99,column:36},end:{line:99,column:37}},loc:{start:{line:99,column:46},end:{line:102,column:13}},line:99},"8":{name:"(anonymous_8)",decl:{start:{line:110,column:30},end:{line:110,column:31}},loc:{start:{line:110,column:72},end:{line:112,column:13}},line:110}},branchMap:{"0":{loc:{start:{line:28,column:8},end:{line:30,column:9}},type:"if",locations:[{start:{line:28,column:8},end:{line:30,column:9}},{start:{line:28,column:8},end:{line:30,column:9}}],line:28},"1":{loc:{start:{line:34,column:12},end:{line:36,column:13}},type:"if",locations:[{start:{line:34,column:12},end:{line:36,column:13}},{start:{line:34,column:12},end:{line:36,column:13}}],line:34},"2":{loc:{start:{line:45,column:8},end:{line:52,column:9}},type:"if",locations:[{start:{line:45,column:8},end:{line:52,column:9}},{start:{line:45,column:8},end:{line:52,column:9}}],line:45}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},inputSourceMap:{version:3,file:"/Users/malynch/D/tracerbench/packages/cli/src/commands/trace.ts",sources:["/Users/malynch/D/tracerbench/packages/cli/src/commands/trace.ts"],names:[],mappings:"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",sourcesContent:["/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport {\n  analyze,\n  IAnalyze,\n  IConditions,\n  ITraceEvent,\n  liveTrace,\n  loadTrace,\n} from \"@tracerbench/core\";\nimport { existsSync, mkdirSync, readJson, writeFileSync } from \"fs-extra\";\nimport { join, resolve } from \"path\";\n\nimport { TBBaseCommand } from \"../command-config\";\nimport {\n  cookiespath,\n  cpuThrottleRate,\n  harpath,\n  network,\n  tbResultsFolder,\n  url,\n} from \"../helpers/flags\";\nimport {\n  isCommitLoad,\n  normalizeFnName,\n  setTraceEvents,\n} from \"../helpers/utils\";\n\nexport default class Trace extends TBBaseCommand {\n  public static description = `Parses a CPU profile and aggregates time across heuristics. Can be vertically sliced with event names.`;\n  public static flags = {\n    cpuThrottleRate: cpuThrottleRate({ required: true }),\n    tbResultsFolder: tbResultsFolder({ required: true }),\n    harpath: harpath({ required: true }),\n    network: network(),\n    url: url({ required: true }),\n    cookiespath: cookiespath({ required: true }),\n  };\n\n  public async run() {\n    const { flags } = this.parse(Trace);\n    const {\n      cpuThrottleRate,\n      cookiespath,\n      tbResultsFolder,\n      network,\n      harpath,\n    } = flags;\n    let { url } = flags;\n    let cookies = [\n      {\n        name: \"\",\n        value: \"\",\n        domain: \"\",\n        path: \"\",\n      },\n    ];\n    const methods = [\"\"];\n    const conditions: IConditions = {\n      cpu: cpuThrottleRate,\n      network,\n    };\n    if (cookiespath.length) {\n      cookies = await readJson(resolve(cookiespath));\n    }\n    // if the folder for the tracerbench results file\n    // does not exist then create it\n    try {\n      if (!existsSync(tbResultsFolder)) {\n        mkdirSync(tbResultsFolder);\n      }\n    } catch (error) {\n      this.error(error);\n    }\n    // validate har and clone it to trace.json\n    const harJSON = await readJson(resolve(harpath));\n    writeFileSync(\n      join(tbResultsFolder, \"trace.json\"),\n      JSON.stringify(harJSON, null, 2)\n    );\n\n    // if no url get url from har\n    if (!url.length) {\n      try {\n        url = harJSON.log.entries[0].request.url;\n      } catch (error) {\n        this.error(\n          `${error}. Could not extract the URL from the HAR. Expliclity pass via \"--url\" flag and rerun.`\n        );\n      }\n    }\n\n    // run the liveTrace\n    const { traceEvents } = await liveTrace(\n      url,\n      tbResultsFolder,\n      cookies,\n      conditions\n    );\n\n    const analyzeOptions: IAnalyze = {\n      traceEvents,\n      traceHARJSON: harJSON,\n      methods,\n    };\n\n    // analyze the liveTrace\n    await analyze(analyzeOptions);\n\n    // js-eval-time\n    let trace: any;\n    let totalJSDuration = 0;\n    let totalCSSDuration = 0;\n\n    const methodsSet = new Set();\n\n    try {\n      trace = setTraceEvents(traceEvents);\n    } catch (error) {\n      this.error(`${error}`);\n    }\n\n    trace\n      .filter((event: ITraceEvent) => event.name === \"EvaluateScript\")\n      .filter((event: any) => event.args.data.url)\n      .forEach((event: any) => {\n        const url = event.args.data.url;\n        const durationInMs = (event.dur as number) / 1000;\n        totalJSDuration += durationInMs;\n        this.log(`JS: ${url}: ${durationInMs.toFixed(2)}`);\n      });\n\n    // log js-eval-time\n    this.log(\n      `JS: Evaluation Total Duration: ${totalJSDuration.toFixed(2)}ms \\n\\n`\n    );\n\n    // css-parse\n    trace\n      .filter((event: ITraceEvent) => event.name === \"ParseAuthorStyleSheet\")\n      .filter((event: any) => event.args.data.styleSheetUrl)\n      .forEach((event: any) => {\n        const url = event.args.data.styleSheetUrl;\n        const durationInMs = event.dur / 1000;\n        totalCSSDuration += durationInMs;\n        this.log(`CSS: ${url}: ${durationInMs.toFixed(2)}`);\n      });\n\n    // log css-parse-time\n    this.log(\n      `CSS: Evaluation Total Duration: ${totalCSSDuration.toFixed(2)}ms \\n\\n`\n    );\n\n    // list-functions\n    try {\n      const profile = loadTrace(trace).cpuProfile(-1, -1);\n      profile.nodeMap.forEach((node: any) => {\n        const { functionName, url, lineNumber, columnNumber } = node.callFrame;\n\n        methodsSet.add(\n          `${url}:${lineNumber}:${columnNumber}.${normalizeFnName(\n            functionName\n          )}`\n        );\n      });\n    } catch (error) {\n      this.error(error);\n    }\n\n    try {\n      trace = setTraceEvents(traceEvents);\n      const traceLoad = trace.filter(isCommitLoad);\n      traceLoad.forEach(\n        ({\n          args: {\n            data: { frame, url },\n          },\n        }: {\n          args: { data: { frame: any; url: any } };\n        }) => {\n          this.log(`Frame-URL: ${url} | Frame-ID: ${frame}`);\n        }\n      );\n    } catch (error) {\n      this.error(`${error}`);\n    }\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"7cbbfb80f4354f6562c91b3e7024040c87468e49"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1wmjbuuxyq=function(){return actualCoverage;};return actualCoverage;}cov_1wmjbuuxyq().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});/* eslint-disable @typescript-eslint/explicit-function-return-type */const core_1=(cov_1wmjbuuxyq().s[1]++,require("@tracerbench/core"));const fs_extra_1=(cov_1wmjbuuxyq().s[2]++,require("fs-extra"));const path_1=(cov_1wmjbuuxyq().s[3]++,require("path"));const command_config_1=(cov_1wmjbuuxyq().s[4]++,require("../command-config"));const flags_1=(cov_1wmjbuuxyq().s[5]++,require("../helpers/flags"));const utils_1=(cov_1wmjbuuxyq().s[6]++,require("../helpers/utils"));class Trace extends(command_config_1.TBBaseCommand){async run(){cov_1wmjbuuxyq().f[0]++;const{flags}=(cov_1wmjbuuxyq().s[7]++,this.parse(Trace));const{cpuThrottleRate,cookiespath,tbResultsFolder,network,harpath}=(cov_1wmjbuuxyq().s[8]++,flags);let{url}=(cov_1wmjbuuxyq().s[9]++,flags);let cookies=(cov_1wmjbuuxyq().s[10]++,[{name:"",value:"",domain:"",path:""}]);const methods=(cov_1wmjbuuxyq().s[11]++,[""]);const conditions=(cov_1wmjbuuxyq().s[12]++,{cpu:cpuThrottleRate,network});cov_1wmjbuuxyq().s[13]++;if(cookiespath.length){cov_1wmjbuuxyq().b[0][0]++;cov_1wmjbuuxyq().s[14]++;cookies=await fs_extra_1.readJson(path_1.resolve(cookiespath));}else{cov_1wmjbuuxyq().b[0][1]++;}// if the folder for the tracerbench results file
// does not exist then create it
cov_1wmjbuuxyq().s[15]++;try{cov_1wmjbuuxyq().s[16]++;if(!fs_extra_1.existsSync(tbResultsFolder)){cov_1wmjbuuxyq().b[1][0]++;cov_1wmjbuuxyq().s[17]++;fs_extra_1.mkdirSync(tbResultsFolder);}else{cov_1wmjbuuxyq().b[1][1]++;}}catch(error){cov_1wmjbuuxyq().s[18]++;this.error(error);}// validate har and clone it to trace.json
const harJSON=(cov_1wmjbuuxyq().s[19]++,await fs_extra_1.readJson(path_1.resolve(harpath)));cov_1wmjbuuxyq().s[20]++;fs_extra_1.writeFileSync(path_1.join(tbResultsFolder,"trace.json"),JSON.stringify(harJSON,null,2));// if no url get url from har
cov_1wmjbuuxyq().s[21]++;if(!url.length){cov_1wmjbuuxyq().b[2][0]++;cov_1wmjbuuxyq().s[22]++;try{cov_1wmjbuuxyq().s[23]++;url=harJSON.log.entries[0].request.url;}catch(error){cov_1wmjbuuxyq().s[24]++;this.error(`${error}. Could not extract the URL from the HAR. Expliclity pass via "--url" flag and rerun.`);}}else{cov_1wmjbuuxyq().b[2][1]++;}// run the liveTrace
const{traceEvents}=(cov_1wmjbuuxyq().s[25]++,await core_1.liveTrace(url,tbResultsFolder,cookies,conditions));const analyzeOptions=(cov_1wmjbuuxyq().s[26]++,{traceEvents,traceHARJSON:harJSON,methods});// analyze the liveTrace
cov_1wmjbuuxyq().s[27]++;await core_1.analyze(analyzeOptions);// js-eval-time
let trace;let totalJSDuration=(cov_1wmjbuuxyq().s[28]++,0);let totalCSSDuration=(cov_1wmjbuuxyq().s[29]++,0);const methodsSet=(cov_1wmjbuuxyq().s[30]++,new Set());cov_1wmjbuuxyq().s[31]++;try{cov_1wmjbuuxyq().s[32]++;trace=utils_1.setTraceEvents(traceEvents);}catch(error){cov_1wmjbuuxyq().s[33]++;this.error(`${error}`);}cov_1wmjbuuxyq().s[34]++;trace.filter(event=>{cov_1wmjbuuxyq().f[1]++;cov_1wmjbuuxyq().s[35]++;return event.name==="EvaluateScript";}).filter(event=>{cov_1wmjbuuxyq().f[2]++;cov_1wmjbuuxyq().s[36]++;return event.args.data.url;}).forEach(event=>{cov_1wmjbuuxyq().f[3]++;const url=(cov_1wmjbuuxyq().s[37]++,event.args.data.url);const durationInMs=(cov_1wmjbuuxyq().s[38]++,event.dur/1000);cov_1wmjbuuxyq().s[39]++;totalJSDuration+=durationInMs;cov_1wmjbuuxyq().s[40]++;this.log(`JS: ${url}: ${durationInMs.toFixed(2)}`);});// log js-eval-time
cov_1wmjbuuxyq().s[41]++;this.log(`JS: Evaluation Total Duration: ${totalJSDuration.toFixed(2)}ms \n\n`);// css-parse
cov_1wmjbuuxyq().s[42]++;trace.filter(event=>{cov_1wmjbuuxyq().f[4]++;cov_1wmjbuuxyq().s[43]++;return event.name==="ParseAuthorStyleSheet";}).filter(event=>{cov_1wmjbuuxyq().f[5]++;cov_1wmjbuuxyq().s[44]++;return event.args.data.styleSheetUrl;}).forEach(event=>{cov_1wmjbuuxyq().f[6]++;const url=(cov_1wmjbuuxyq().s[45]++,event.args.data.styleSheetUrl);const durationInMs=(cov_1wmjbuuxyq().s[46]++,event.dur/1000);cov_1wmjbuuxyq().s[47]++;totalCSSDuration+=durationInMs;cov_1wmjbuuxyq().s[48]++;this.log(`CSS: ${url}: ${durationInMs.toFixed(2)}`);});// log css-parse-time
cov_1wmjbuuxyq().s[49]++;this.log(`CSS: Evaluation Total Duration: ${totalCSSDuration.toFixed(2)}ms \n\n`);// list-functions
cov_1wmjbuuxyq().s[50]++;try{const profile=(cov_1wmjbuuxyq().s[51]++,core_1.loadTrace(trace).cpuProfile(-1,-1));cov_1wmjbuuxyq().s[52]++;profile.nodeMap.forEach(node=>{cov_1wmjbuuxyq().f[7]++;const{functionName,url,lineNumber,columnNumber}=(cov_1wmjbuuxyq().s[53]++,node.callFrame);cov_1wmjbuuxyq().s[54]++;methodsSet.add(`${url}:${lineNumber}:${columnNumber}.${utils_1.normalizeFnName(functionName)}`);});}catch(error){cov_1wmjbuuxyq().s[55]++;this.error(error);}cov_1wmjbuuxyq().s[56]++;try{cov_1wmjbuuxyq().s[57]++;trace=utils_1.setTraceEvents(traceEvents);const traceLoad=(cov_1wmjbuuxyq().s[58]++,trace.filter(utils_1.isCommitLoad));cov_1wmjbuuxyq().s[59]++;traceLoad.forEach(({args:{data:{frame,url}}})=>{cov_1wmjbuuxyq().f[8]++;cov_1wmjbuuxyq().s[60]++;this.log(`Frame-URL: ${url} | Frame-ID: ${frame}`);});}catch(error){cov_1wmjbuuxyq().s[61]++;this.error(`${error}`);}}}cov_1wmjbuuxyq().s[62]++;exports.default=Trace;cov_1wmjbuuxyq().s[63]++;Trace.description=`Parses a CPU profile and aggregates time across heuristics. Can be vertically sliced with event names.`;cov_1wmjbuuxyq().s[64]++;Trace.flags={cpuThrottleRate:flags_1.cpuThrottleRate({required:true}),tbResultsFolder:flags_1.tbResultsFolder({required:true}),harpath:flags_1.harpath({required:true}),network:flags_1.network(),url:flags_1.url({required:true}),cookiespath:flags_1.cookiespath({required:true})};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL21hbHluY2gvRC90cmFjZXJiZW5jaC9wYWNrYWdlcy9jbGkvc3JjL2NvbW1hbmRzL3RyYWNlLnRzIiwic291cmNlcyI6WyIvVXNlcnMvbWFseW5jaC9EL3RyYWNlcmJlbmNoL3BhY2thZ2VzL2NsaS9zcmMvY29tbWFuZHMvdHJhY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxxRUFBcUU7QUFDckUsNENBTzJCO0FBQzNCLHVDQUEwRTtBQUMxRSwrQkFBcUM7QUFFckMsc0RBQWtEO0FBQ2xELDRDQU8wQjtBQUMxQiw0Q0FJMEI7QUFFMUIsTUFBcUIsS0FBTSxTQUFRLDhCQUFhO0lBV3ZDLEtBQUssQ0FBQyxHQUFHO1FBQ2QsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEMsTUFBTSxFQUNKLGVBQWUsRUFDZixXQUFXLEVBQ1gsZUFBZSxFQUNmLE9BQU8sRUFDUCxPQUFPLEdBQ1IsR0FBRyxLQUFLLENBQUM7UUFDVixJQUFJLEVBQUUsR0FBRyxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLElBQUksT0FBTyxHQUFHO1lBQ1o7Z0JBQ0UsSUFBSSxFQUFFLEVBQUU7Z0JBQ1IsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsTUFBTSxFQUFFLEVBQUU7Z0JBQ1YsSUFBSSxFQUFFLEVBQUU7YUFDVDtTQUNGLENBQUM7UUFDRixNQUFNLE9BQU8sR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3JCLE1BQU0sVUFBVSxHQUFnQjtZQUM5QixHQUFHLEVBQUUsZUFBZTtZQUNwQixPQUFPO1NBQ1IsQ0FBQztRQUNGLElBQUksV0FBVyxDQUFDLE1BQU0sRUFBRTtZQUN0QixPQUFPLEdBQUcsTUFBTSxtQkFBUSxDQUFDLGNBQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1NBQ2hEO1FBQ0QsaURBQWlEO1FBQ2pELGdDQUFnQztRQUNoQyxJQUFJO1lBQ0YsSUFBSSxDQUFDLHFCQUFVLENB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LENBQ2YsQ0FBQyxFQUNDLElBQUksRUFBRSxFQUNKLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FDckIsR0FHRixFQUFFLEVBQUU7Z0JBQ0gsSUFBSSxDQUFDLEdBQUcsQ0FBQyxjQUFjLEdBQUcsZ0JBQWdCLEtBQUssRUFBRSxDQUFDLENBQUM7WUFDckQsQ0FBQyxDQUNGLENBQUM7U0FDSDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssRUFBRSxDQUFDLENBQUM7U0FDeEI7SUFDSCxDQUFDOztBQTlKSCx3QkErSkM7QUE5SmUsaUJBQVcsR0FBRyx3R0FBd0csQ0FBQztBQUN2SCxXQUFLLEdBQUc7SUFDcEIsZUFBZSxFQUFFLHVCQUFlLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDcEQsZUFBZSxFQUFFLHVCQUFlLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDcEQsT0FBTyxFQUFFLGVBQU8sQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQztJQUNwQyxPQUFPLEVBQUUsZUFBTyxFQUFFO0lBQ2xCLEdBQUcsRUFBRSxXQUFHLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDNUIsV0FBVyxFQUFFLG1CQUFXLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7Q0FDN0MsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZSAqL1xuaW1wb3J0IHtcbiAgYW5hbHl6ZSxcbiAgSUFuYWx5emUsXG4gIElDb25kaXRpb25zLFxuICBJVHJhY2VFdmVudCxcbiAgbGl2ZVRyYWNlLFxuICBsb2FkVHJhY2UsXG59IGZyb20gXCJAdHJhY2VyYmVuY2gvY29yZVwiO1xuaW1wb3J0IHsgZXhpc3RzU3luYywgbWtkaXJTeW5jLCByZWFkSnNvbiwgd3JpdGVGaWxlU3luYyB9IGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IHsgam9pbiwgcmVzb2x2ZSB9IGZyb20gXCJwYXRoXCI7XG5cbmltcG9ydCB7IFRCQmFzZUNvbW1hbmQgfSBmcm9tIFwiLi4vY29tbWFuZC1jb25maWdcIjtcbmltcG9ydCB7XG4gIGNvb2tpZXNwYXRoLFxuICBjcHVUaHJvdHRsZVJhdGUsXG4gIGhhcnBhdGgsXG4gIG5ldHdvcmssXG4gIHRiUmVzdWx0c0ZvbGRlcixcbiAgdXJsLFxufSBmcm9tIFwiLi4vaGVscGVycy9mbGFnc1wiO1xuaW1wb3J0IHtcbiAgaXNDb21taXRMb2FkLFxuICBub3JtYWxpemVGbk5hbWUsXG4gIHNldFRyYWNlRXZlbnRzLFxufSBmcm9tIFwiLi4vaGVscGVycy91dGlsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmFjZSBleHRlbmRzIFRCQmFzZUNvbW1hbmQge1xuICBwdWJsaWMgc3RhdGljIGRlc2NyaXB0aW9uID0gYFBhcnNlcyBhIENQVSBwcm9maWxlIGFuZCBhZ2dyZWdhdGVzIHRpbWUgYWNyb3NzIGhldXJpc3RpY3MuIENhbiBiZSB2ZXJ0aWNhbGx5IHNsaWNlZCB3aXRoIGV2ZW50IG5hbWVzLmA7XG4gIHB1YmxpYyBzdGF0aWMgZmxhZ3MgPSB7XG4gICAgY3B1VGhyb3R0bGVSYXRlOiBjcHVUaHJvdHRsZVJhdGUoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICB0YlJlc3VsdHNGb2xkZXI6IHRiUmVzdWx0c0ZvbGRlcih7IHJlcXVpcmVkOiB0cnVlIH0pLFxuICAgIGhhcnBhdGg6IGhhcnBhdGgoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICBuZXR3b3JrOiBuZXR3b3JrKCksXG4gICAgdXJsOiB1cmwoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICBjb29raWVzcGF0aDogY29va2llc3BhdGgoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgfTtcblxuICBwdWJsaWMgYXN5bmMgcnVuKCkge1xuICAgIGNvbnN0IHsgZmxhZ3MgfSA9IHRoaXMucGFyc2UoVHJhY2UpO1xuICAgIGNvbnN0IHtcbiAgICAgIGNwdVRocm90dGxlUmF0ZSxcbiAgICAgIGNvb2tpZXNwYXRoLFxuICAgICAgdGJSZXN1bHRzRm9sZGVyLFxuICAgICAgbmV0d29yayxcbiAgICAgIGhhcnBhdGgsXG4gICAgfSA9IGZsYWdzO1xuICAgIGxldCB7IHVybCB9ID0gZmxhZ3M7XG4gICAgbGV0IGNvb2tpZXMgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBkb21haW46IFwiXCIsXG4gICAgICAgIHBhdGg6IFwiXCIsXG4gICAgICB9LFxuICAgIF07XG4gICAgY29uc3QgbWV0aG9kcyA9IFtcIlwiXTtcbiAgICBjb25zdCBjb25kaXRpb25zOiBJQ29uZGl0aW9ucyA9IHtcbiAgICAgIGNwdTogY3B1VGhyb3R0bGVSYXRlLFxuICAgICAgbmV0d29yayxcbiAgICB9O1xuICAgIGlmIChjb29raWVzcGF0aC5sZW5ndGgpIHtcbiAgICAgIGNvb2tpZXMgPSBhd2FpdCByZWFkSnNvbihyZXNvbHZlKGNvb2tpZXNwYXRoKSk7XG4gICAgfVxuICAgIC8vIGlmIHRoZSBmb2xkZXIgZm9yIHRoZSB0cmFjZXJiZW5jaCByZXN1bHRzIGZpbGVcbiAgICAvLyBkb2VzIG5vdCBleGlzdCB0aGVuIGNyZWF0ZSBpdFxuICAgIHRyeSB7XG4gICAgICBpZiAoIWV4aXN0c1N5bmModGJSZXN1bHRzRm9sZGVyKSkge1xuICAgICAgICBta2RpclN5bmModGJSZXN1bHRzRm9sZGVyKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5lcnJvcihlcnJvcik7XG4gICAgfVxuICAgIC8vIHZhbGlkYXRlIGhhciBhbmQgY2xvbmUgaXQgdG8gdHJhY2UuanNvblxuICAgIGNvbnN0IGhhckpTT04gPSBhd2FpdCByZWFkSnNvbihyZXNvbHZlKGhhcnBhdGgpKTtcbiAgICB3cml0ZUZpbGVTeW5jKFxuICAgICAgam9pbih0YlJlc3VsdHNGb2xkZXIsIFwidHJhY2UuanNvblwiKSxcbiAgICAgIEpTT04uc3RyaW5naWZ5KGhhckpTT04sIG51bGwsIDIpXG4gICAgKTtcblxuICAgIC8vIGlmIG5vIHVybCBnZXQgdXJsIGZyb20gaGFyXG4gICAgaWYgKCF1cmwubGVuZ3RoKSB7XG4gICAgICB0cnkge1xuICAgICAgICB1cmwgPSBoYXJKU09OLmxvZy5lbnRyaWVzWzBdLnJlcXVlc3QudXJsO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvcihcbiAgICAgICAgICBgJHtlcnJvcn0uIENvdWxkIG5vdCBleHRyYWN0IHRoZSBVUkwgZnJvbSB0aGUgSEFSLiBFeHBsaWNsaXR5IHBhc3MgdmlhIFwiLS11cmxcIiBmbGFnIGFuZCByZXJ1bi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gcnVuIHRoZSBsaXZlVHJhY2VcbiAgICBjb25zdCB7IHRyYWNlRXZlbnRzIH0gPSBhd2FpdCBsaXZlVHJhY2UoXG4gICAgICB1cmwsXG4gICAgICB0YlJlc3VsdHNGb2xkZXIsXG4gICAgICBjb29raWVzLFxuICAgICAgY29uZGl0aW9uc1xuICAgICk7XG5cbiAgICBjb25zdCBhbmFseXplT3B0aW9uczogSUFuYWx5emUgPSB7XG4gICAgICB0cmFjZUV2ZW50cyxcbiAgICAgIHRyYWNlSEFSSlNPTjogaGFySlNPTixcbiAgICAgIG1ldGhvZHMsXG4gICAgfTtcblxuICAgIC8vIGFuYWx5emUgdGhlIGxpdmVUcmFjZVxuICAgIGF3YWl0IGFuYWx5emUoYW5hbHl6ZU9wdGlvbnMpO1xuXG4gICAgLy8ganMtZXZhbC10aW1lXG4gICAgbGV0IHRyYWNlOiBhbnk7XG4gICAgbGV0IHRvdGFsSlNEdXJhdGlvbiA9IDA7XG4gICAgbGV0IHRvdGFsQ1NTRHVyYXRpb24gPSAwO1xuXG4gICAgY29uc3QgbWV0aG9kc1NldCA9IG5ldyBTZXQoKTtcblxuICAgIHRyeSB7XG4gICAgICB0cmFjZSA9IHNldFRyYWNlRXZlbnRzKHRyYWNlRXZlbnRzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5lcnJvcihgJHtlcnJvcn1gKTtcbiAgICB9XG5cbiAgICB0cmFjZVxuICAgICAgLmZpbHRlcigoZXZlbnQ6IElUcmFjZUV2ZW50KSA9PiBldmVudC5uYW1lID09PSBcIkV2YWx1YXRlU2NyaXB0XCIpXG4gICAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiBldmVudC5hcmdzLmRhdGEudXJsKVxuICAgICAgLmZvckVhY2goKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgdXJsID0gZXZlbnQuYXJncy5kYXRhLnVybDtcbiAgICAgICAgY29uc3QgZHVyYXRpb25Jbk1zID0gKGV2ZW50LmR1ciBhcyBudW1iZXIpIC8gMTAwMDtcbiAgICAgICAgdG90YWxKU0R1cmF0aW9uICs9IGR1cmF0aW9uSW5NcztcbiAgICAgICAgdGhpcy5sb2coYEpTOiAke3VybH06ICR7ZHVyYXRpb25Jbk1zLnRvRml4ZWQoMil9YCk7XG4gICAgICB9KTtcblxuICAgIC8vIGxvZyBqcy1ldmFsLXRpbWVcbiAgICB0aGlzLmxvZyhcbiAgICAgIGBKUzogRXZhbHVhdGlvbiBUb3RhbCBEdXJhdGlvbjogJHt0b3RhbEpTRHVyYXRpb24udG9GaXhlZCgyKX1tcyBcXG5cXG5gXG4gICAgKTtcblxuICAgIC8vIGNzcy1wYXJzZVxuICAgIHRyYWNlXG4gICAgICAuZmlsdGVyKChldmVudDogSVRyYWNlRXZlbnQpID0+IGV2ZW50Lm5hbWUgPT09IFwiUGFyc2VBdXRob3JTdHlsZVNoZWV0XCIpXG4gICAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiBldmVudC5hcmdzLmRhdGEuc3R5bGVTaGVldFVybClcbiAgICAgIC5mb3JFYWNoKChldmVudDogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGV2ZW50LmFyZ3MuZGF0YS5zdHlsZVNoZWV0VXJsO1xuICAgICAgICBjb25zdCBkdXJhdGlvbkluTXMgPSBldmVudC5kdXIgLyAxMDAwO1xuICAgICAgICB0b3RhbENTU0R1cmF0aW9uICs9IGR1cmF0aW9uSW5NcztcbiAgICAgICAgdGhpcy5sb2coYENTUzogJHt1cmx9OiAke2R1cmF0aW9uSW5Ncy50b0ZpeGVkKDIpfWApO1xuICAgICAgfSk7XG5cbiAgICAvLyBsb2cgY3NzLXBhcnNlLXRpbWVcbiAgICB0aGlzLmxvZyhcbiAgICAgIGBDU1M6IEV2YWx1YXRpb24gVG90YWwgRHVyYXRpb246ICR7dG90YWxDU1NEdXJhdGlvbi50b0ZpeGVkKDIpfW1zIFxcblxcbmBcbiAgICApO1xuXG4gICAgLy8gbGlzdC1mdW5jdGlvbnNcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZmlsZSA9IGxvYWRUcmFjZSh0cmFjZSkuY3B1UHJvZmlsZSgtMSwgLTEpO1xuICAgICAgcHJvZmlsZS5ub2RlTWFwLmZvckVhY2goKG5vZGU6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCB7IGZ1bmN0aW9uTmFtZSwgdXJsLCBsaW5lTnVtYmVyLCBjb2x1bW5OdW1iZXIgfSA9IG5vZGUuY2FsbEZyYW1lO1xuXG4gICAgICAgIG1ldGhvZHNTZXQuYWRkKFxuICAgICAgICAgIGAke3VybH06JHtsaW5lTnVtYmVyfToke2NvbHVtbk51bWJlcn0uJHtub3JtYWxpemVGbk5hbWUoXG4gICAgICAgICAgICBmdW5jdGlvbk5hbWVcbiAgICAgICAgICApfWBcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmVycm9yKGVycm9yKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdHJhY2UgPSBzZXRUcmFjZUV2ZW50cyh0cmFjZUV2ZW50cyk7XG4gICAgICBjb25zdCB0cmFjZUxvYWQgPSB0cmFjZS5maWx0ZXIoaXNDb21taXRMb2FkKTtcbiAgICAgIHRyYWNlTG9hZC5mb3JFYWNoKFxuICAgICAgICAoe1xuICAgICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICAgIGRhdGE6IHsgZnJhbWUsIHVybCB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH06IHtcbiAgICAgICAgICBhcmdzOiB7IGRhdGE6IHsgZnJhbWU6IGFueTsgdXJsOiBhbnkgfSB9O1xuICAgICAgICB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5sb2coYEZyYW1lLVVSTDogJHt1cmx9IHwgRnJhbWUtSUQ6ICR7ZnJhbWV9YCk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuZXJyb3IoYCR7ZXJyb3J9YCk7XG4gICAgfVxuICB9XG59XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWx5bmNoL0QvdHJhY2VyYmVuY2gvcGFja2FnZXMvY2xpL3NyYy9jb21tYW5kcy90cmFjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiZ3pmQUFBLHFFQUNBLEtBQUEsQ0FBQSxNQUFBLDBCQUFBLE9BQUEsQ0FBQSxtQkFBQSxDQUFBLENBQUEsQ0FRQSxLQUFBLENBQUEsVUFBQSwwQkFBQSxPQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsTUFBQSwwQkFBQSxPQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FFQSxLQUFBLENBQUEsZ0JBQUEsMEJBQUEsT0FBQSxDQUFBLG1CQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxPQUFBLDBCQUFBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLENBQUEsQ0FRQSxLQUFBLENBQUEsT0FBQSwwQkFBQSxPQUFBLENBQUEsa0JBQUEsQ0FBQSxDQUFBLENBTUEsS0FBcUIsQ0FBQSxLQUFyQixTQUFtQyxnQkFBQSxDQUFBLGFBQW5DLENBQWdELENBV3ZDLEtBQU0sQ0FBQSxHQUFOLEVBQVMseUJBQ2QsS0FBTSxDQUFFLEtBQUYsMkJBQVksS0FBSyxLQUFMLENBQVcsS0FBWCxDQUFaLENBQU4sQ0FDQSxLQUFNLENBQ0osZUFESSxDQUVKLFdBRkksQ0FHSixlQUhJLENBSUosT0FKSSxDQUtKLE9BTEksMkJBTUYsS0FORSxDQUFOLENBT0EsR0FBSSxDQUFFLEdBQUYsMkJBQVUsS0FBVixDQUFKLENBQ0EsR0FBSSxDQUFBLE9BQU8sMkJBQUcsQ0FDWixDQUNFLElBQUksQ0FBRSxFQURSLENBRUUsS0FBSyxDQUFFLEVBRlQsQ0FHRSxNQUFNLENBQUUsRUFIVixDQUlFLElBQUksQ0FBRSxFQUpSLENBRFksQ0FBSCxDQUFYLENBUUEsS0FBTSxDQUFBLE9BQU8sMkJBQUcsQ0FBQyxFQUFELENBQUgsQ0FBYixDQUNBLEtBQU0sQ0FBQSxVQUFVLDJCQUFnQixDQUM5QixHQUFHLENBQUUsZUFEeUIs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UUFBUSxDQUFFLElBQVosQ0FBSixDQUxlLENBTXBCLFdBQVcsQ0FBRSxPQUFBLENBQUEsV0FBQSxDQUFZLENBQUUsUUFBUSxDQUFFLElBQVosQ0FBWixDQU5PLENBQVIsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZSAqL1xuaW1wb3J0IHtcbiAgYW5hbHl6ZSxcbiAgSUFuYWx5emUsXG4gIElDb25kaXRpb25zLFxuICBJVHJhY2VFdmVudCxcbiAgbGl2ZVRyYWNlLFxuICBsb2FkVHJhY2UsXG59IGZyb20gXCJAdHJhY2VyYmVuY2gvY29yZVwiO1xuaW1wb3J0IHsgZXhpc3RzU3luYywgbWtkaXJTeW5jLCByZWFkSnNvbiwgd3JpdGVGaWxlU3luYyB9IGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IHsgam9pbiwgcmVzb2x2ZSB9IGZyb20gXCJwYXRoXCI7XG5cbmltcG9ydCB7IFRCQmFzZUNvbW1hbmQgfSBmcm9tIFwiLi4vY29tbWFuZC1jb25maWdcIjtcbmltcG9ydCB7XG4gIGNvb2tpZXNwYXRoLFxuICBjcHVUaHJvdHRsZVJhdGUsXG4gIGhhcnBhdGgsXG4gIG5ldHdvcmssXG4gIHRiUmVzdWx0c0ZvbGRlcixcbiAgdXJsLFxufSBmcm9tIFwiLi4vaGVscGVycy9mbGFnc1wiO1xuaW1wb3J0IHtcbiAgaXNDb21taXRMb2FkLFxuICBub3JtYWxpemVGbk5hbWUsXG4gIHNldFRyYWNlRXZlbnRzLFxufSBmcm9tIFwiLi4vaGVscGVycy91dGlsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmFjZSBleHRlbmRzIFRCQmFzZUNvbW1hbmQge1xuICBwdWJsaWMgc3RhdGljIGRlc2NyaXB0aW9uID0gYFBhcnNlcyBhIENQVSBwcm9maWxlIGFuZCBhZ2dyZWdhdGVzIHRpbWUgYWNyb3NzIGhldXJpc3RpY3MuIENhbiBiZSB2ZXJ0aWNhbGx5IHNsaWNlZCB3aXRoIGV2ZW50IG5hbWVzLmA7XG4gIHB1YmxpYyBzdGF0aWMgZmxhZ3MgPSB7XG4gICAgY3B1VGhyb3R0bGVSYXRlOiBjcHVUaHJvdHRsZVJhdGUoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICB0YlJlc3VsdHNGb2xkZXI6IHRiUmVzdWx0c0ZvbGRlcih7IHJlcXVpcmVkOiB0cnVlIH0pLFxuICAgIGhhcnBhdGg6IGhhcnBhdGgoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICBuZXR3b3JrOiBuZXR3b3JrKCksXG4gICAgdXJsOiB1cmwoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgICBjb29raWVzcGF0aDogY29va2llc3BhdGgoeyByZXF1aXJlZDogdHJ1ZSB9KSxcbiAgfTtcblxuICBwdWJsaWMgYXN5bmMgcnVuKCkge1xuICAgIGNvbnN0IHsgZmxhZ3MgfSA9IHRoaXMucGFyc2UoVHJhY2UpO1xuICAgIGNvbnN0IHtcbiAgICAgIGNwdVRocm90dGxlUmF0ZSxcbiAgICAgIGNvb2tpZXNwYXRoLFxuICAgICAgdGJSZXN1bHRzRm9sZGVyLFxuICAgICAgbmV0d29yayxcbiAgICAgIGhhcnBhdGgsXG4gICAgfSA9IGZsYWdzO1xuICAgIGxldCB7IHVybCB9ID0gZmxhZ3M7XG4gICAgbGV0IGNvb2tpZXMgPSBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBkb21haW46IFwiXCIsXG4gICAgICAgIHBhdGg6IFwiXCIsXG4gICAgICB9LFxuICAgIF07XG4gICAgY29uc3QgbWV0aG9kcyA9IFtcIlwiXTtcbiAgICBjb25zdCBjb25kaXRpb25zOiBJQ29uZGl0aW9ucyA9IHtcbiAgICAgIGNwdTogY3B1VGhyb3R0bGVSYXRlLFxuICAgICAgbmV0d29yayxcbiAgICB9O1xuICAgIGlmIChjb29raWVzcGF0aC5sZW5ndGgpIHtcbiAgICAgIGNvb2tpZXMgPSBhd2FpdCByZWFkSnNvbihyZXNvbHZlKGNvb2tpZXNwYXRoKSk7XG4gICAgfVxuICAgIC8vIGlmIHRoZSBmb2xkZXIgZm9yIHRoZSB0cmFjZXJiZW5jaCByZXN1bHRzIGZpbGVcbiAgICAvLyBkb2VzIG5vdCBleGlzdCB0aGVuIGNyZWF0ZSBpdFxuICAgIHRyeSB7XG4gICAgICBpZiAoIWV4aXN0c1N5bmModGJSZXN1bHRzRm9sZGVyKSkge1xuICAgICAgICBta2RpclN5bmModGJSZXN1bHRzRm9sZGVyKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5lcnJvcihlcnJvcik7XG4gICAgfVxuICAgIC8vIHZhbGlkYXRlIGhhciBhbmQgY2xvbmUgaXQgdG8gdHJhY2UuanNvblxuICAgIGNvbnN0IGhhckpTT04gPSBhd2FpdCByZWFkSnNvbihyZXNvbHZlKGhhcnBhdGgpKTtcbiAgICB3cml0ZUZpbGVTeW5jKFxuICAgICAgam9pbih0YlJlc3VsdHNGb2xkZXIsIFwidHJhY2UuanNvblwiKSxcbiAgICAgIEpTT04uc3RyaW5naWZ5KGhhckpTT04sIG51bGwsIDIpXG4gICAgKTtcblxuICAgIC8vIGlmIG5vIHVybCBnZXQgdXJsIGZyb20gaGFyXG4gICAgaWYgKCF1cmwubGVuZ3RoKSB7XG4gICAgICB0cnkge1xuICAgICAgICB1cmwgPSBoYXJKU09OLmxvZy5lbnRyaWVzWzBdLnJlcXVlc3QudXJsO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvcihcbiAgICAgICAgICBgJHtlcnJvcn0uIENvdWxkIG5vdCBleHRyYWN0IHRoZSBVUkwgZnJvbSB0aGUgSEFSLiBFeHBsaWNsaXR5IHBhc3MgdmlhIFwiLS11cmxcIiBmbGFnIGFuZCByZXJ1bi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gcnVuIHRoZSBsaXZlVHJhY2VcbiAgICBjb25zdCB7IHRyYWNlRXZlbnRzIH0gPSBhd2FpdCBsaXZlVHJhY2UoXG4gICAgICB1cmwsXG4gICAgICB0YlJlc3VsdHNGb2xkZXIsXG4gICAgICBjb29raWVzLFxuICAgICAgY29uZGl0aW9uc1xuICAgICk7XG5cbiAgICBjb25zdCBhbmFseXplT3B0aW9uczogSUFuYWx5emUgPSB7XG4gICAgICB0cmFjZUV2ZW50cyxcbiAgICAgIHRyYWNlSEFSSlNPTjogaGFySlNPTixcbiAgICAgIG1ldGhvZHMsXG4gICAgfTtcblxuICAgIC8vIGFuYWx5emUgdGhlIGxpdmVUcmFjZVxuICAgIGF3YWl0IGFuYWx5emUoYW5hbHl6ZU9wdGlvbnMpO1xuXG4gICAgLy8ganMtZXZhbC10aW1lXG4gICAgbGV0IHRyYWNlOiBhbnk7XG4gICAgbGV0IHRvdGFsSlNEdXJhdGlvbiA9IDA7XG4gICAgbGV0IHRvdGFsQ1NTRHVyYXRpb24gPSAwO1xuXG4gICAgY29uc3QgbWV0aG9kc1NldCA9IG5ldyBTZXQoKTtcblxuICAgIHRyeSB7XG4gICAgICB0cmFjZSA9IHNldFRyYWNlRXZlbnRzKHRyYWNlRXZlbnRzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5lcnJvcihgJHtlcnJvcn1gKTtcbiAgICB9XG5cbiAgICB0cmFjZVxuICAgICAgLmZpbHRlcigoZXZlbnQ6IElUcmFjZUV2ZW50KSA9PiBldmVudC5uYW1lID09PSBcIkV2YWx1YXRlU2NyaXB0XCIpXG4gICAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiBldmVudC5hcmdzLmRhdGEudXJsKVxuICAgICAgLmZvckVhY2goKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgdXJsID0gZXZlbnQuYXJncy5kYXRhLnVybDtcbiAgICAgICAgY29uc3QgZHVyYXRpb25Jbk1zID0gKGV2ZW50LmR1ciBhcyBudW1iZXIpIC8gMTAwMDtcbiAgICAgICAgdG90YWxKU0R1cmF0aW9uICs9IGR1cmF0aW9uSW5NcztcbiAgICAgICAgdGhpcy5sb2coYEpTOiAke3VybH06ICR7ZHVyYXRpb25Jbk1zLnRvRml4ZWQoMil9YCk7XG4gICAgICB9KTtcblxuICAgIC8vIGxvZyBqcy1ldmFsLXRpbWVcbiAgICB0aGlzLmxvZyhcbiAgICAgIGBKUzogRXZhbHVhdGlvbiBUb3RhbCBEdXJhdGlvbjogJHt0b3RhbEpTRHVyYXRpb24udG9GaXhlZCgyKX1tcyBcXG5cXG5gXG4gICAgKTtcblxuICAgIC8vIGNzcy1wYXJzZVxuICAgIHRyYWNlXG4gICAgICAuZmlsdGVyKChldmVudDogSVRyYWNlRXZlbnQpID0+IGV2ZW50Lm5hbWUgPT09IFwiUGFyc2VBdXRob3JTdHlsZVNoZWV0XCIpXG4gICAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiBldmVudC5hcmdzLmRhdGEuc3R5bGVTaGVldFVybClcbiAgICAgIC5mb3JFYWNoKChldmVudDogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGV2ZW50LmFyZ3MuZGF0YS5zdHlsZVNoZWV0VXJsO1xuICAgICAgICBjb25zdCBkdXJhdGlvbkluTXMgPSBldmVudC5kdXIgLyAxMDAwO1xuICAgICAgICB0b3RhbENTU0R1cmF0aW9uICs9IGR1cmF0aW9uSW5NcztcbiAgICAgICAgdGhpcy5sb2coYENTUzogJHt1cmx9OiAke2R1cmF0aW9uSW5Ncy50b0ZpeGVkKDIpfWApO1xuICAgICAgfSk7XG5cbiAgICAvLyBsb2cgY3NzLXBhcnNlLXRpbWVcbiAgICB0aGlzLmxvZyhcbiAgICAgIGBDU1M6IEV2YWx1YXRpb24gVG90YWwgRHVyYXRpb246ICR7dG90YWxDU1NEdXJhdGlvbi50b0ZpeGVkKDIpfW1zIFxcblxcbmBcbiAgICApO1xuXG4gICAgLy8gbGlzdC1mdW5jdGlvbnNcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZmlsZSA9IGxvYWRUcmFjZSh0cmFjZSkuY3B1UHJvZmlsZSgtMSwgLTEpO1xuICAgICAgcHJvZmlsZS5ub2RlTWFwLmZvckVhY2goKG5vZGU6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCB7IGZ1bmN0aW9uTmFtZSwgdXJsLCBsaW5lTnVtYmVyLCBjb2x1bW5OdW1iZXIgfSA9IG5vZGUuY2FsbEZyYW1lO1xuXG4gICAgICAgIG1ldGhvZHNTZXQuYWRkKFxuICAgICAgICAgIGAke3VybH06JHtsaW5lTnVtYmVyfToke2NvbHVtbk51bWJlcn0uJHtub3JtYWxpemVGbk5hbWUoXG4gICAgICAgICAgICBmdW5jdGlvbk5hbWVcbiAgICAgICAgICApfWBcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmVycm9yKGVycm9yKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdHJhY2UgPSBzZXRUcmFjZUV2ZW50cyh0cmFjZUV2ZW50cyk7XG4gICAgICBjb25zdCB0cmFjZUxvYWQgPSB0cmFjZS5maWx0ZXIoaXNDb21taXRMb2FkKTtcbiAgICAgIHRyYWNlTG9hZC5mb3JFYWNoKFxuICAgICAgICAoe1xuICAgICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICAgIGRhdGE6IHsgZnJhbWUsIHVybCB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH06IHtcbiAgICAgICAgICBhcmdzOiB7IGRhdGE6IHsgZnJhbWU6IGFueTsgdXJsOiBhbnkgfSB9O1xuICAgICAgICB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5sb2coYEZyYW1lLVVSTDogJHt1cmx9IHwgRnJhbWUtSUQ6ICR7ZnJhbWV9YCk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuZXJyb3IoYCR7ZXJyb3J9YCk7XG4gICAgfVxuICB9XG59XG4iXX0=